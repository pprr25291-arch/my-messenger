<!DOCTYPE html>
<html>
<head>
    <title>Anonimo - Чат</title>
    <link rel="stylesheet" href="/style.css">
   <script>
// Передаем username из серверного рендеринга в клиентский JavaScript
const USERNAME = '<%= username %>';

// Токен будет доступен через куки (httpOnly) или можно получить его из localStorage
// если вы его там сохраняли при регистрации/логине
const USER_TOKEN = document.cookie.replace(/(?:(?:^|.*;\s*)token\s*=\s*([^;]*).*$)|^.*$/, '$1');
</script>
    </script>
</head>
<body>
    <div class="chat-container">
        <header>
            <h2>Anonimo</h2>
            <div>
                <span>Добро пожаловать, <span id="username"><%= username %></span>!</span>
                <div class="header-buttons">
                    <button id="globalBtn" class="header-btn active" type="button">Общий чат</button>
                    <button id="privateBtn" class="header-btn" type="button">Приватные сообщения</button>
                    <button class="header-btn" type="button" onclick="logout()">Выйти</button>
                </div>
            </div>
        </header>
        
        <!-- Глобальный чат -->
        <div id="globalChat">
            <div id="messages"></div>
            <form id="messageForm">
                <input type="text" id="messageInput" placeholder="Введите сообщение..." autocomplete="off">
                <button type="submit">Отправить</button>
            </form>
        </div>
        
        <!-- Приватный чат -->
        <div id="privateChat" style="display: none;"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/webrtc.js"></script>
    <script src="/chat.js"></script>
    <script src="/private-chat.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('globalBtn').addEventListener('click', switchToGlobal);
            document.getElementById('privateBtn').addEventListener('click', switchToPrivate);
        });
    </script>
</body>
</html>